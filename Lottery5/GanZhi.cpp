#include "stdafx.h"
#include "GanZhi.h"
//常量定义
const TCHAR * TIANGAN = _T("甲乙丙丁戊己庚辛壬癸");
const TCHAR * DIZHI = _T("子丑寅卯辰巳午未申酉戌亥");
const int JIAZIYear = 4; //甲子年
const BYTE TwentyFourData[] = {//二十四节气数据
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1901
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x87,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1902
    0x96,   0xA5,   0x87,   0x96,   0x87,   0x87,   0x79,   0x69,   0x69,   0x69,   0x78,   0x78,       //1903
    0x86,   0xA5,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x78,   0x87,       //1904
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1905
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1906
    0x96,   0xA5,   0x87,   0x96,   0x87,   0x87,   0x79,   0x69,   0x69,   0x69,   0x78,   0x78,       //1907
    0x86,   0xA5,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1908
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1909
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1910
    0x96,   0xA5,   0x87,   0x96,   0x87,   0x87,   0x79,   0x69,   0x69,   0x69,   0x78,   0x78,       //1911
    0x86,   0xA5,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1912
    0x95,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1913
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1914
    0x96,   0xA5,   0x97,   0x96,   0x97,   0x87,   0x79,   0x79,   0x69,   0x69,   0x78,   0x78,       //1915
    0x96,   0xA5,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1916
    0x95,   0xB4,   0x96,   0xA6,   0x96,   0x97,   0x78,   0x79,   0x78,   0x69,   0x78,   0x87,       //1917
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x77,       //1918
    0x96,   0xA5,   0x97,   0x96,   0x97,   0x87,   0x79,   0x79,   0x69,   0x69,   0x78,   0x78,       //1919
    0x96,   0xA5,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1920
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x78,   0x79,   0x78,   0x69,   0x78,   0x87,       //1921
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x77,       //1922
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x87,   0x79,   0x79,   0x69,   0x69,   0x78,   0x78,       //1923
    0x96,   0xA5,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1924
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x78,   0x79,   0x78,   0x69,   0x78,   0x87,       //1925
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1926
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x87,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1927
    0x96,   0xA5,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1928
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1929
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1930
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x87,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1931
    0x96,   0xA5,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1932
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1933
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1934
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1935
    0x96,   0xA5,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1936
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1937
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1938
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1939
    0x96,   0xA5,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1940
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1941
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1942
    0x96,   0xA4,   0x96,   0x96,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1943
    0x96,   0xA5,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1944
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1945
    0x95,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x78,   0x69,   0x78,   0x77,       //1946
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1947
    0x96,   0xA5,   0xA6,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //1948
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x79,   0x78,   0x79,   0x77,   0x87,       //1949
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x78,   0x79,   0x78,   0x69,   0x78,   0x77,       //1950
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x79,   0x79,   0x79,   0x69,   0x78,   0x78,       //1951
    0x96,   0xA5,   0xA6,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //1952
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1953
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x78,   0x79,   0x78,   0x68,   0x78,   0x87,       //1954
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1955
    0x96,   0xA5,   0xA5,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //1956
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1957
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1958
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1959
    0x96,   0xA4,   0xA5,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //1960
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1961
    0x96,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1962
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1963
    0x96,   0xA4,   0xA5,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //1964
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1965
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1966
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1967
    0x96,   0xA4,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //1968
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1969
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1970
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x79,   0x69,   0x78,   0x77,       //1971
    0x96,   0xA4,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //1972
    0xA5,   0xB5,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1973
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1974
    0x96,   0xB4,   0x96,   0xA6,   0x97,   0x97,   0x78,   0x79,   0x78,   0x69,   0x78,   0x77,       //1975
    0x96,   0xA4,   0xA5,   0xB5,   0xA6,   0xA6,   0x88,   0x89,   0x88,   0x78,   0x87,   0x87,       //1976
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //1977
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x78,   0x87,       //1978
    0x96,   0xB4,   0x96,   0xA6,   0x96,   0x97,   0x78,   0x79,   0x78,   0x69,   0x78,   0x77,       //1979
    0x96,   0xA4,   0xA5,   0xB5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //1980
    0xA5,   0xB4,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x77,   0x87,       //1981
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1982
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x78,   0x79,   0x78,   0x69,   0x78,   0x77,       //1983
    0x96,   0xB4,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x87,       //1984
    0xA5,   0xB4,   0xA6,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //1985
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1986
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x79,   0x78,   0x69,   0x78,   0x87,       //1987
    0x96,   0xB4,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //1988
    0xA5,   0xB4,   0xA5,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //1989
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //1990
    0x95,   0xB4,   0x96,   0xA5,   0x86,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1991
    0x96,   0xB4,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //1992
    0xA5,   0xB3,   0xA5,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //1993
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1994
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x76,   0x78,   0x69,   0x78,   0x87,       //1995
    0x96,   0xB4,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //1996
    0xA5,   0xB3,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //1997
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //1998
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //1999
    0x96,   0xB4,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //2000
    0xA5,   0xB3,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //2001
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //2002
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //2003
    0x96,   0xB4,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //2004
    0xA5,   0xB3,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //2005
    0xA5,   0xB4,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //2006
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x69,   0x78,   0x87,       //2007
    0x96,   0xB4,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x87,   0x78,   0x87,   0x86,       //2008
    0xA5,   0xB3,   0xA5,   0xB5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //2009
    0xA5,   0xB4,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //2010
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x78,   0x87,       //2011
    0x96,   0xB4,   0xA5,   0xB5,   0xA5,   0xA6,   0x87,   0x88,   0x87,   0x78,   0x87,   0x86,       //2012
    0xA5,   0xB3,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x87,       //2013
    0xA5,   0xB4,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //2014
    0x95,   0xB4,   0x96,   0xA5,   0x96,   0x97,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //2015
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA6,   0x87,   0x88,   0x87,   0x78,   0x87,   0x86,       //2016
    0xA5,   0xC3,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x87,       //2017
    0xA5,   0xB4,   0xA6,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //2018
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //2019
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA6,   0x97,   0x87,   0x87,   0x78,   0x87,   0x86,       //2020
    0xA5,   0xC3,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //2021
    0xA5,   0xB4,   0xA5,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //2022
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x79,   0x77,   0x87,       //2023
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA6,   0x97,   0x87,   0x87,   0x78,   0x87,   0x96,       //2024
    0xA5,   0xC3,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //2025
    0xA5,   0xB3,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //2026
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //2027
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA6,   0x97,   0x87,   0x87,   0x78,   0x87,   0x96,       //2028
    0xA5,   0xC3,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //2029
    0xA5,   0xB3,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //2030
    0xA5,   0xB4,   0x96,   0xA5,   0x96,   0x96,   0x88,   0x78,   0x78,   0x78,   0x87,   0x87,       //2031
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA6,   0x97,   0x87,   0x87,   0x78,   0x87,   0x96,       //2032
    0xA5,   0xC3,   0xA5,   0xB5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x86,       //2033
    0xA5,   0xB3,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x78,   0x88,   0x78,   0x87,   0x87,       //2034
    0xA5,   0xB4,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //2035
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA6,   0x97,   0x87,   0x87,   0x78,   0x87,   0x96,       //2036
    0xA5,   0xC3,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x86,       //2037
    0xA5,   0xB3,   0xA5,   0xA5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //2038
    0xA5,   0xB4,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //2039
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA6,   0x97,   0x87,   0x87,   0x78,   0x87,   0x96,       //2040
    0xA5,   0xC3,   0xA5,   0xB5,   0xA5,   0xA6,   0x87,   0x88,   0x87,   0x78,   0x87,   0x86,       //2041
    0xA5,   0xB3,   0xA5,   0xB5,   0xA6,   0xA6,   0x88,   0x88,   0x88,   0x78,   0x87,   0x87,       //2042
    0xA5,   0xB4,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //2043
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA6,   0x97,   0x87,   0x87,   0x88,   0x87,   0x96,       //2044
    0xA5,   0xC3,   0xA5,   0xB4,   0xA5,   0xA6,   0x87,   0x88,   0x87,   0x78,   0x87,   0x86,       //2045
    0xA5,   0xB3,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x88,   0x78,   0x87,   0x87,       //2046
    0xA5,   0xB4,   0x96,   0xA5,   0xA6,   0x96,   0x88,   0x88,   0x78,   0x78,   0x87,   0x87,       //2047
    0x95,   0xB4,   0xA5,   0xB4,   0xA5,   0xA5,   0x97,   0x87,   0x87,   0x88,   0x86,   0x96,       //2048
    0xA4,   0xC3,   0xA5,   0xA5,   0xA5,   0xA6,   0x97,   0x87,   0x87,   0x78,   0x87,   0x86,       //2049
    0xA5,   0xC3,   0xA5,   0xB5,   0xA6,   0xA6,   0x87,   0x88,   0x78,   0x78,   0x87,   0x87        //2050
};//二十四节气数据

//在pTcharBuffer中拼接天干地支年月日
void YMD2TD(TCHAR * pTcharBuffer, int iYear, int iMonth, int iDay)
{
    //这里是月:
    //首先确定处于哪个节气期间
    int iYDataOffset = iYear - 1901;
    BYTE tfdata = TwentyFourData[iYDataOffset*12+iMonth-1];
    int ilday = 15 - (tfdata >> 4);
    int irday = tfdata & 0x0F + 15;
    int iMDzOffset = iMonth;
    if (iDay < ilday)
        iMDzOffset--;

    //这里是年：
    //天干地支独立循环，到甲子第二次碰头完成一次轮回
    int iYOffset = (iYear - JIAZIYear) % 60;//60年为一轮回
    int iYTgOffset4Month = iYOffset % 10;
    if (iMonth < 2 || ((iMonth == 2) && (iDay < ilday)))
        iYOffset = (iYOffset + 60 - 1) % 60;
    int iYTgOffset = iYOffset % 10;
    int iYDzOffset = iYOffset % 12;

    //月跟年有关系
    int iMTgOffset = ((iYTgOffset4Month%5)*12 + iMDzOffset) % 10;

    //这里是日：
    int iYear4Day = iYear;
    int M = iMonth;
    if(iMonth < 3)
    {
        M +=12;
        iYear4Day--;
    }
    int C = iYear4Day / 100;
    int y = iYear4Day - (iYear4Day / 100 * 100);
    int i = ( (M+1) % 2)*6;
    int g = 4*C + C/4 + 5*y + y/4 + 3*(M+1)/5 + iDay - 4;
    int z = 8*C + C/4 + 5*y + y/4 + 3*(M+1)/5 + iDay + 6 + i;

    int iDTgOffset = g%10;
    int iDDzOffset = z%12;

    //TODO: 验证pOutputBuffer的可用性

    TCHAR tcTemp[]={TIANGAN[iYTgOffset], DIZHI[iYDzOffset], _T(' '),
        TIANGAN[iMTgOffset], DIZHI[iMDzOffset==12?0:iMDzOffset], _T(' '),
        TIANGAN[iDTgOffset], DIZHI[iDDzOffset], _T(' '), _T('\0')};
    _tcscat(pTcharBuffer, tcTemp);
} 